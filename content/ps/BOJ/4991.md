---
title: '4991. ë¡œë´‡ ì²­ì†Œê¸°'
metaTitle: 'ë§Œë ™ ê°œë°œì í‚¤ìš°ê¸°'
metaDescription: 'ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í’€ê³  ì •ë¦¬í•œ ê³³ì…ë‹ˆë‹¤.'
tags: ['ê·¸ë˜í”„ ì´ë¡ ', 'ê·¸ë˜í”„ íƒìƒ‰', 'BFS', 'ë¹„íŠ¸ë§ˆìŠ¤í‚¹', 'ë¸Œë£¨íŠ¸í¬ìŠ¤']
date: '2021-04-22'
---

# ë¬¸ì œ

- [4991. ë¡œë´‡ ì²­ì†Œê¸°](https://www.acmicpc.net/problem/4991)

## ì½”ë“œ

<details><summary> ì½”ë“œ ë³´ê¸° </summary>

```java
import java.awt.Point;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.LinkedList;
import java.util.List;
import java.util.Queue;

public class Q4991 {
    static int w, h, x, y, messy;
    static int dx[] = {-1, 0, 1, 0}, dy[] = {0, 1, 0, -1};
    static int cache[][][];
    static char board[][];
    static boolean visited[][];
    static List<Point> dest;
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        while(true) {
            init(br);
            if(w == 0 && h == 0) break;
            System.out.println(solution(x, y, 0, 0));
        }
    }

    private static int solution(int sx, int sy, int v, int cnt) {
        if(cnt == messy) return 0;

        if(cache[sx][sy][v] != -1)
            return cache[sx][sy][v];

        int ret = 987654321;
        cache[sx][sy][v] = ret;

        for (int i = 0; i < messy; i++) {
            if(((1 << i) & v ) > 0)
                continue;

            Point p = dest.get(i);
            int cost = bfs(sx, sy, p.x, p.y);
            int next = solution(p.x, p.y, v | (1 << i), cnt + 1);

            /* í•´ë‹¹ ì§€ì ì— ë„ë‹¬í•  ìˆ˜ ì—†ëŠ” ê²½ìš° ëª¨ë“  ì¬ê·€ íƒˆì¶œ */
            if(cost == -1 || next == -1)
                return -1;
            ret = Math.min(ret, cost + next);
        }

        /* ì“°ë ˆê¸°ê°€ ë†“ì¸ ì§€ì ì´ ì¡´ì¬í•˜ì§€ë§Œ, íƒìƒ‰ì„ ì§„í–‰í•  ìˆ˜ ì—†ëŠ” ê²½ìš° = ì˜ˆì™¸ ìƒí™© */
        if(ret == 987654321) return -1;
        return cache[sx][sy][v] = ret;
    }

    private static int bfs(int sx, int sy, int ex, int ey) {
        int count = 0;

        Queue<Point> q = new LinkedList<>();
        q.add(new Point(sx, sy));

        visited = new boolean[h][w];
        visited[sx][sy] = true;
        board[sx][sy] = '.';

        while (!q.isEmpty()) {
            int size = q.size();

            /* ì´ë™í•œ íšŸìˆ˜ ì¦ê°€ */
            count += 1;

            for (int i = 0; i < size; i++) {
                Point here = q.poll();

                /* 4ê°€ì§€ ë°©í–¥ìœ¼ë¡œ íƒìƒ‰ ì‹œë„ */
                for (int d = 0; d < 4; d++) {
                    int nx = here.x + dx[d], ny = here.y + dy[d];
                    if(!isBorder(nx, ny) || visited[nx][ny] || board[nx][ny] == 'x')
                        continue;

                    /* ëª©ì ì§€ ë„ì°© */
                    if(nx == ex && ny == ey){
                        x = nx;
                        y = ny;
                        board[nx][ny] = '.';
                        return count;
                    }

                    visited[nx][ny] = true;
                    q.add(new Point(nx, ny));
                }
            }
        }

        /* ëª©ì ì§€ì— ë„ë‹¬í•  ìˆ˜ ì—†ëŠ” ê²½ìš° */
        return -1;
    }

    private static boolean isBorder(int x, int y) {
        return (x >= 0 && x < h && y >= 0 && y < w);
    }

    private static void init(BufferedReader br) throws IOException {
        String[] input = br.readLine().split(" ");
        h = stoi(input[1]);
        w = stoi(input[0]);
        board = new char[h][w];
        cache = new int[h][w][1<<11];
        messy = 0;
        dest = new ArrayList<>();
        for (int i = 0; i < h; i++) {
            board[i] = br.readLine().toCharArray();
            for(int j = 0; j < w; ++j){
                Arrays.fill(cache[i][j], -1);

                if(board[i][j] == '*') {
                    messy += 1;
                    dest.add(new Point(i, j));
                }
                else if(board[i][j] == 'o'){
                    x = i;
                    y = j;
                }
            }
        }
    }

    private static int stoi(String str) {
        return Integer.parseInt(str);
    }
}

/*

5 5
....*
.*.*.
..o..
..*..
.....
8

6 5
.....*
.*..*.
...o..
.*....
......
10

 */
```

</details>

## â­ï¸ëŠë‚€ì â­ï¸

> ì²˜ìŒì—” ë‹¨ìˆœíˆ ê°€ì¥ ë¨¼ì € ë„ì°©í•˜ëŠ” ì§€ì ì—ì„œ ëª¨ë“  ë°©ë¬¸ì²´í¬ë¥¼ ì´ˆê¸°í™”í•˜ê³  ë‹¤ì‹œ ê°€ì¥ ê°€ê¹Œìš´ ì§€ì ìœ¼ë¡œ í•˜ë‚˜ì”© ì´ë™í•˜ëŠ” ì‹ìœ¼ë¡œ êµ¬í˜„í–ˆë‹¤ê°€ ë°˜ë¡€ë¥¼ ë°œê²¬í•˜ê³  ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ êµ¬í˜„í–ˆë‹¤.
>
> ì‚¼ì„±ê¸°ì¶œ `ì¹˜í‚¨ ë°°ë‹¬` ë¬¸ì œë‘ ë¹„ìŠ·í•œ ëŠë‚Œì´ì—ˆë‹¤.

## í’€ì´ ğŸ“£

<hr/>

1ï¸âƒ£ ì“°ë ˆê¸°ê°€ ìˆëŠ” ì§€ì ì˜ ì¢Œí‘œë“¤ì„ ëª¨ë‘ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥í•´ë‘”ë‹¤.

2ï¸âƒ£ ëª¨ë“  ì§€ì ì— ê°ˆ ìˆ˜ ìˆëŠ” ëª¨ë“  ìˆœì„œëŒ€ë¡œ íƒìƒ‰í•´ë³¸ í›„ ê°€ì¥ ë¹„ìš©ì´ ì ê²Œ ê±¸ë¦¬ëŠ” ê²½ë¡œë¥¼ ì •ë‹µìœ¼ë¡œ êµ¬í•œë‹¤.

    - cache[í˜„ì¬ ì§€ì  xì¢Œí‘œ][í˜„ì¬ ì§€ì  yì¢Œí‘œ][ì§€ë‚˜ì˜¨ ê²½ë¡œ] ë¥¼ ì €ì¥í•´ë‘ê³ , ì¤‘ë³µê³„ì‚°ì„ ë°©ì§€í•œë‹¤.

    - ìµœëŒ€ ë°©ë¬¸ ì§€ì ì´ 10ê°œ ì´í•˜ì´ë¯€ë¡œ, ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ íƒìƒ‰ ì‹œê°„ì„ ëŒ€í­ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

3ï¸âƒ£ í˜„ì¬ê¹Œì§€ ë°©ë¬¸í•˜ì§€ ì•Šì•˜ë˜ ì§€ì ìœ¼ë¡œ íƒìƒ‰í•´ë³¸ë‹¤.

    - ië²ˆì§¸ ì§€ì ì„ ë°©ë¬¸í•  ë•Œ, (v & (1 << i)) > 0 ì´ë©´ ì´ë¯¸ ì§€ë‚˜ì˜¨ ê²½ë¡œì— í¬í•¨ë¨ì„ ì˜ë¯¸í•˜ë¯€ë¡œ íƒìƒ‰ì„ ì§„í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤.

    - ië²ˆì§¸ ì§€ì ì„ ë¹„íŠ¸ë§ˆìŠ¤í‚¹ìœ¼ë¡œ ì¶”ê°€í•œ í›„, ë°©ë¬¸í•œ ì§€ì ì˜ ì¹´ìš´íŠ¸ë¥¼ 1ê°œ ì¦ê°€ì‹œì¼œì„œ ì¬ê·€ì ìœ¼ë¡œ ë‹¤ì‹œ íƒìƒ‰í•œë‹¤.

    - ë§Œì•½ í•´ë‹¹ ì§€ì ê¹Œì§€ ë„ë‹¬í•  ìˆ˜ ì—†ë‹¤ë©´ -1ì„ ë°˜í™˜í•˜ì—¬ ëª¨ë“  ì¬ê·€ë¥¼ íƒˆì¶œ í›„ -1ì„ ì¶œë ¥í•œë‹¤.

4ï¸âƒ£ ìµœì¢…ì ìœ¼ë¡œ êµ¬í•œ ìµœì†Œ ë¹„ìš©ì„ ì¶œë ¥í•˜ê³  ì¢…ë£Œí•œë‹¤.

## ì‹¤ìˆ˜ ğŸ˜…

<hr/>

- ëˆˆì— ë³´ì´ëŠ” ëŒ€ë¡œ ê°€ì¥ ê°€ê¹Œìš´ ì§€ì ë¶€í„° ë„ë‹¬í•˜ë ¤ê³  í•˜ë©´ ë°˜ë¡€ê°€ ìƒê¹€ì„ ë’¤ëŠ¦ê²Œ ê¹¨ë‹¬ì•˜ë‹¤.

* `ì¹˜í‚¨ ë°°ë‹¬` ë¬¸ì œì—ì„œ í’€ì—ˆë˜ ë°©ë²•ì´ ë– ì˜¬ë¼ í•´ë‹¹ ë°©ë²•ì— `ë¹„íŠ¸ ë§ˆìŠ¤í‚¹`ê³¼ `DP` ë¥¼ ì¶”ê°€í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.

- ë‚˜ì¤‘ì— í’€ì´ë“¤ì„ ë³´ë©´ì„œ ê° ì¢Œí‘œê°„ ì´ë™ ê±°ë¦¬ë¥¼ ë¯¸ë¦¬ êµ¬í•´ë†“ê³  ì´ë“¤ì˜ `MST`ë¥¼ êµ¬í•˜ëŠ” í’€ì´ë„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.

* ì¢‹ì€ ì•„ì´ë””ì–´ë¥¼ ì–»ì„ ìˆ˜ ìˆì—ˆê¸°ì—, ë‹¤ìŒì— `MST` ê´€ë ¨ëœ ë¬¸ì œë¥¼ í’€ì–´ë³¼ ì˜ˆì •ì´ë‹¤
