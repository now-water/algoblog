---
title: '1559. ë†€ë¼ìš´ ë¯¸ë¡œ'
metaTitle: 'ë§Œë ™ ê°œë°œì í‚¤ìš°ê¸°'
metaDescription: 'ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í’€ê³  ì •ë¦¬í•œ ê³³ì…ë‹ˆë‹¤.'
tags: ['ê·¸ë˜í”„ ì´ë¡ ', 'ê·¸ë˜í”„ íƒìƒ‰', 'BFS', 'ë¹„íŠ¸ë§ˆìŠ¤í‚¹']
date: '2021-06-28'
---

# ë¬¸ì œ
- [1559. ë†€ë¼ìš´ ë¯¸ë¡œ](https://www.acmicpc.net/problem/1559)

## ì½”ë“œ

<details><summary> ì½”ë“œ ë³´ê¸° </summary>

``` java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.LinkedList;
import java.util.Queue;
import java.util.StringTokenizer;

class Status {
    int d, x, y, t;

    public Status(int d, int x, int y, int t) {
        this.d = d;
        this.x = x;
        this.y = y;
        this.t = t;
    }
}
public class Q1559 {
    static int M, N, K, doors[][];
    static int treasure[][];
    static boolean visited[][][][]; // ë°©í–¥, X, Y, ë³´ë¬¼
    static int dx[] = {-1, 0, 1, 0}, dy[] = {0, 1, 0, -1};
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        while(true) {
            init(br);
            if(M == 0 && N == 0) break;
            solution();
        }
    }

    private static void solution() {
        int time = 0;
        Queue<Status> q = new LinkedList<>();
        q.add(new Status(doors[0][0], 0, 0, 0));
        visited[doors[0][0]][0][0][0] = true;
        while (!q.isEmpty()) {
            int size = q.size();
            for (int s = 0; s < size; s++) {
                Status here = q.poll();
                int x = here.x, y = here.y, t = here.t, d = here.d;

                // ë³´ë¬¼ì„ ë°œê²¬í•œ ê²½ìš°
                if(treasure[x][y] > 0){
                    t |= (1 << (treasure[x][y] - 1));
                }
                
                // ëª¨ë“  ë³´ë¬¼ì„ ì°¾ê³  ëª©ì ì§€ì— ë„ë‹¬í•œ ê²½ìš° íƒˆì¶œ
                if(t == (1<<K)-1 && x == M-1 && y == N-1){
                    System.out.println(time);
                    return;
                }

                // ë‹¤ìŒ ì¹¸ìœ¼ë¡œ ì´ë™ì‹œí‚¨ ìœ„ì¹˜ì™€ íšŒì „ì‹œí‚¨ ë°©í–¥
                int nd = (d+1)%4;
                int nx = x + dx[d], ny = y + dy[d];

                // ì œìë¦¬ì—ì„œ ë¬¸ì´ íšŒì „í•˜ê¸¸ ëŒ€ê¸°í•˜ëŠ” ê²½ìš°
                if(!visited[nd][x][y][t]){
                    visited[nd][x][y][t] = true;
                    q.add(new Status(nd, x, y, t));
                }

                // í˜„ì¬ ë¬¸ìœ¼ë¡œ ì´ë™í–ˆì„ ë•Œ ì¥ì™¸ë¡œ ë²—ì–´ë‚˜ë©´ íƒìƒ‰ X
                if(!isBorder(nx, ny))
                    continue;

                // í˜„ì¬ ë¬¸ìœ¼ë¡œ ì´ë™í•˜ëŠ” ê²½ìš°
                nd = (doors[nx][ny] + time + 1) % 4;
                if(!visited[nd][nx][ny][t]){
                    visited[nd][nx][ny][t] = true;
                    q.add(new Status(nd, nx, ny, t));
                }
            }
            time += 1;
        }
    }

    private static boolean isBorder(int x, int y) {
        return (x >= 0 && x < M && y >= 0 && y < N);
    }

    private static void init(BufferedReader br) throws IOException {
        StringTokenizer st = new StringTokenizer(br.readLine());
        M = stoi(st.nextToken());
        N = stoi(st.nextToken());

        if(M == 0 && N == 0) return;

        doors = new int[M][N];
        treasure = new int[M][N];
        visited = new boolean[4][100][100][256];
        for (int i = 0; i < M; i++) {
            char[] line = br.readLine().toCharArray();
            for (int j = 0; j < N; j++) {
                doors[i][j] = getDirection(line[j]);
            }
        }
        K = stoi(br.readLine());
        int kt = 1;
        for (int i = 0; i < K; i++) {
            st = new StringTokenizer(br.readLine());
            int x = stoi(st.nextToken()) - 1;
            int y = stoi(st.nextToken()) - 1;
            treasure[x][y] = kt++;
        }
    }

    private static int getDirection(char c) {
        switch(c){
            case 'N': return 0;
            case 'E': return 1;
            case 'S': return 2;
            case 'W': return 3;
        }
        return -1;
    }

    private static int stoi(String str) {
        return Integer.parseInt(str);
    }
}
```
</details>

## â­ï¸ëŠë‚€ì â­ï¸

> BFS ë¬¸ì œì—ì„œ ê½¤ ë‚œì´ë„ê°€ ë†’ì€ ë¬¸ì œì˜€ë‹¤. ë¹„íŠ¸ë§ˆìŠ¤í‚¹ + íšŒì „ + ê·¸ë˜í”„ íƒìƒ‰ì„ ê³ ë ¤í•œ êµ¬í˜„ ë¬¸ì œì´ë‹¤


## í’€ì´ ğŸ“£
<hr/>

1ï¸âƒ£ ëª¨ë“  ë³´ë¬¼ íšë“ ìƒí™©ì„ ë¹„íŠ¸ë§ˆìŠ¤í¬ë¡œ í‘œí˜„í•œë‹¤.

    - 1ê°œ~8ê°œ ì‚¬ì´ì´ë¯€ë¡œ, 2^8 ê°œì˜ ë¹„íŠ¸ë¡œ í‘œí˜„ì´ ê°€ëŠ¥í•˜ë‹¤.

    - ë˜í•œ ë¹„íŠ¸ë§ˆìŠ¤í¬ë¡œ ê´€ë¦¬í•˜ì˜€ì„ ë•Œ, ë°©ë¬¸ ì²˜ë¦¬ ì¡°ê±´ì— ì •ìˆ˜í˜•ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.

    - ë³´ë¬¼ì˜ ìœ„ì¹˜ë¥¼ ì…ë ¥ë°›ì„ ë•Œ, ê° ë³´ë¬¼ì˜ ìˆœì„œë¥¼ 2ì°¨ì› ë°°ì—´ë¡œ ì €ì¥í•œë‹¤.

    - ì´í›„ ë³´ë¬¼ íšë“ ì‹œ í•´ë‹¹ ìœ„ì¹˜ì— ì €ì¥ëœ ë³´ë¬¼ì˜ ìˆœì„œë¥¼ í†µí•´ ë³´ë¬¼ íšë“ì„ í‘œì‹œí•œë‹¤. t |= (1 << treasure[x][y]) - 1


2ï¸âƒ£ ë³´ë¬¼ì„ ë‹¤ íšë“í•œ í›„ ëª©í‘œ ì§€ì ì— ë„ë‹¬í•´ì•¼ ì¢…ë£Œëœë‹¤.

    - ë”°ë¼ì„œ ê·¸ì „ê¹Œì§€ ëª¨ë“  ê°€ëŠ¥í•œ ê²½ë¡œë¥¼ íƒìƒ‰í•˜ë©´ì„œ ë³´ë¬¼ì„ íšë“í•˜ê³ , ëª©í‘œ ì§€ì ì— ë„ë‹¬í•´ì•¼ í•œë‹¤.

    - visited[ë„ë‹¬í•  ì‹œì ì˜ ë¬¸ì˜ ë°©í–¥][X ì¢Œí‘œ][Y ì¢Œí‘œ][íšë“í•œ ë³´ë¬¼ ìƒíƒœ] ë¡œ ë°©ë¬¸ ì²´í¬ë¥¼ í•˜ë©´ ì¤‘ë³µ ë°©ë¬¸ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.


3ï¸âƒ£ íŠ¹ì • ì‹œì ì— ë¬¸ì´ íšŒì „í•œ ìƒí™©ì„ ê³ ë ¤í•˜ì—¬ íì— ê° ì´ë™ ìƒí™©ì„ ì €ì¥ì‹œí‚¤ë©° íƒìƒ‰ì„ ì‹œë„í•œë‹¤.

    - ì‹œê°„ì´ ì§€ë‚  ë•Œë§ˆë‹¤ ë¬¸ì€ ë¶, ë™, ë‚¨, ì„œ ìˆœìœ¼ë¡œ íšŒì „í•œë‹¤.

    - ê° ë¬¸ì˜ ìƒíƒœë¥¼ 0, 1, 2, 3 ìœ¼ë¡œ ê´€ë¦¬í•˜ê³ , íšŒì „ ì‹œ (í˜„ì¬ ìƒíƒœ + 1) % 4 ë¡œ ë‹¤ìŒ ë¬¸ì˜ ìœ„ì¹˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


4ï¸âƒ£ íƒìƒ‰ì€ ì œìë¦¬ì—ì„œ ë¬¸ì´ íšŒì „í•˜ê¸¸ ê¸°ë‹¤ë¦¬ê±°ë‚˜, í˜„ì¬ ë¬¸ìœ¼ë¡œ ì´ë™í•˜ëŠ” ê²½ìš°ë¡œ ë‚˜ë‰˜ì–´ì§„ë‹¤. 

    - ì œìë¦¬ì—ì„œ ë¬¸ì´ íšŒì „í•˜ê¸¸ ê¸°ë‹¤ë¦´ ê²½ìš°, íì—ëŠ” ((í˜„ì¬ ë¬¸ì˜ ìƒíƒœ + 1) % 4, x, y, t) ë¥¼ ë„£ì–´ì£¼ê³  ê° íŒŒë¼ë¯¸í„°ì— ë§ëŠ” ë°©ë¬¸ ì²˜ë¦¬ë¥¼ í•´ì¤€ë‹¤.

    - í˜„ì¬ ë¬¸ì„ í†µí•´ ë‹¤ìŒ ì¹¸ìœ¼ë¡œ ì´ë™í•  ê²½ìš°, íì—ëŠ” ((ë‹¤ìŒ ì¹¸ì˜ ë¬¸ì˜ ìƒíƒœ + 1) % 4, nx, ny, t) ë¥¼ ë„£ì–´ì£¼ê³  ê° íŒŒë¼ë¯¸í„°ì— ë§ëŠ” ë°©ë¬¸ ì²˜ë¦¬ë¥¼ í•´ì¤€ë‹¤.


5ï¸âƒ£ ì´ë ‡ê²Œ íƒìƒ‰ì„ ê³„ì† ë°©ë¬¸í•˜ë‹¤ê°€ ì¢…ë£Œ ì¡°ê±´ì„ ìµœì´ˆë¡œ ë§Œì¡±ì‹œì¼°ì„ ë•Œ, ê·¸ë•Œê¹Œì§€ ê²½ê³¼í•œ ì‹œê°„ì„ ì¶œë ¥í•˜ê³  ì¢…ë£Œí•œë‹¤.


## ì‹¤ìˆ˜ ğŸ˜…
<hr/>

- ì²˜ìŒì— ë¬¸ì œë¥¼ ì˜ëª» ì½ì–´ì„œ ì…ë ¥ë°›ì€ ë³´ë“œ ì „ì²´ê°€ 1ì´ˆë§ˆë‹¤ 90ë„ë¡œ íšŒì „í•˜ëŠ” ì¤„ ì•Œê³  ì§„ì§œ ë³µì¡í•˜ê² ë‹¤ê³  ìƒê°í–ˆì—ˆë‹¤.. ì•Œê³ ë³´ë‹ˆ ë¬¸ì˜ ìœ„ì¹˜ë§Œ 1ì´ˆë§ˆë‹¤ íšŒì „í•˜ëŠ” ê²ƒì´ì—ˆë‹¤.

- ë¬¸ì œë¥¼ ì œëŒ€ë¡œ íŒŒì•…í•˜ê³ , êµ¬í˜„í•˜ëŠ”ë°ëŠ” í¬ê²Œ ì–´ë ¤ìš´ ê³¼ì •ì€ ì—†ì—ˆë‹¤. ì¡°ê±´ì— ë§ê²Œ ë°©ë¬¸ ì²˜ë¦¬ë¥¼ í•´ì£¼ëŠ” ê²ƒì´ í•µì‹¬ì´ì—ˆë‹¤.