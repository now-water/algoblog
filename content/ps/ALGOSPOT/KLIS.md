---
title: 'KLIS'
metaTitle: 'ë§Œë ™ ê°œë°œì í‚¤ìš°ê¸°'
metaDescription: 'ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í’€ê³  ì •ë¦¬í•œ ê³³ì…ë‹ˆë‹¤.'
tags: ['DP']
date: '2021-01-17'
---

# ë¬¸ì œ

- [KLIS](https://www.algospot.com/judge/problem/read/KLIS)

## ì½”ë“œ

<details><summary> ì½”ë“œ ë³´ê¸° </summary>

```javascript
#include <iostream>
#include <vector>
#include <algorithm>
#include <string>
#include <cstring>
#define MAX_VAL 2000000000 + 1
using namespace std;
vector<int> arr;
int cache_lis[501], cache_cnt[501];

// arr[idx] ì—ì„œ ì‹œì‘í•˜ëŠ” ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ ì¤‘ ìµœëŒ€ ê¸¸ì´ ë°˜í™˜.
int lis(int idx)
{
	int& ret = cache_lis[idx + 1];
	if (ret != -1) return ret;
	ret = 1; // arr[idx] ëŠ” í•­ìƒ ìˆìœ¼ë¯€ë¡œ 1ì´ë‹¤.
	for (int next = idx + 1; next < arr.size(); ++next)
		if (idx == -1 || arr[idx] < arr[next])
			ret = max(ret, 1 + lis(next));
	return ret;
}
// arr[idx] ì—ì„œ ì‹œì‘í•˜ëŠ” ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê°œìˆ˜ ë°˜í™˜.
int count(int idx)
{
	if (lis(idx) == 1) return 1;
	int& ret = cache_cnt[idx];
	if (ret != -1) return ret;
	ret = 0;
	for (int next = idx + 1; next < arr.size(); ++next)
		if((idx == -1 || arr[idx] < arr[next]) &&
			lis(idx) == lis(next) + 1)
			ret = min<long long>(MAX_VAL, (long long)ret + count(next));
	return ret;
}
// arr[start]ì—ì„œ ì‹œì‘í•˜ëŠ” LIS ì¤‘ ì‚¬ì „ ìˆœìœ¼ë¡œ skipê°œ ê±´ë„ˆë›´ ìˆ˜ì—´ì„ strì— ì €ì¥í•œë‹¤.
void reconstruct(int start, int skip, vector<int>& str)
{
	// 1. arr[start]ëŠ” í•­ìƒ strì— í¬í•¨í•œë‹¤.
	// -> ì¬ê·€ë¥¼ ë“¤ì–´ì˜¨ë‹¤ëŠ” ê²ƒì€ ë” ì´ìƒ skipì„ ëª»í•˜ê³  í•´ë‹¹ ìˆ«ìë¥¼ í¬í•¨í•œ ìˆ˜ì—´ì´ë¼ëŠ” ì˜ë¯¸ê¸° ë•Œë¬¸.
	if(start != -1) str.push_back(arr[start]);

	// 2. ë’¤ì— ì˜¬ ìˆ˜ ìˆëŠ” ìˆ«ìë“¤ê³¼ ìœ„ì¹˜ì˜ ëª©ë¡ì„ ë§Œë“ ë‹¤.
	// (ìˆ«ì, ìˆ«ìì˜ ìœ„ì¹˜)ì˜ ëª©ë¡
	vector<pair<int, int>> followers;
	for (int next = start + 1; next < arr.size(); ++next)
		if ((start == -1 || arr[start] < arr[next]) && lis(start) == lis(next) + 1)
			followers.push_back(make_pair(arr[next], next));
	sort(followers.begin(), followers.end());

	// 3. K ë²ˆì§¸ LISì˜ ë‹¤ìŒ ìˆ«ìë¥¼ ì°¾ëŠ”ë‹¤.
	for (int i = 0; i < followers.size(); ++i)
	{
		// ì´ ìˆ«ìë¥¼ ë’¤ì— ì´ì–´ì„œ ë§Œë“¤ ìˆ˜ ìˆëŠ” LISì˜ ê°œìˆ˜ë¥¼ ë³¸ë‹¤.
		int idx = followers[i].second;
		int cnt = count(idx);
		if (cnt <= skip) skip -= cnt;
		else {
			// ë‹¤ìŒ ìˆ«ìëŠ” arr[idx] ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.
			// 4. ì¬ê·€í˜¸ì¶œì„ ì‹œí–‰í•œë‹¤.
			reconstruct(idx, skip, str);
			break;
		}
	}
}
int main()
{
	int tc;
	cin >> tc;
	while (tc-- > 0) {
		int n, k, res = 0;
		cin >> n >> k;
		arr.resize(n);
		memset(cache_lis, -1, sizeof(cache_lis));
		memset(cache_cnt, -1, sizeof(cache_cnt));
		for (int i = 0; i < n; ++i) cin >> arr[i];
		cout << lis(-1) - 1 << '\n';

		vector<int> str;
		reconstruct(-1, k - 1, str);
		for (auto& elem : str)
			cout << elem << ' ';
		cout << '\n';
		arr.clear();
	}
}
```

</details>

## â­ï¸ëŠë‚€ì â­ï¸

> ì²˜ìŒì— skip í•´ì£¼ëŠ” ê³¼ì •ì´ ì´í•´ê°€ ì•ˆë˜ì„œ ì±…ì˜ ì„¤ëª…ì„ í•œì°¸ ë´¤ë‹¤. ê·¸ë˜ë„ ì´í•´ê°€ ì•ˆë˜ì„œ ì½”ë“œë¥¼ ë³´ë©´ì„œ ë¬¸ì œì˜ ë³¸ì§ˆì„ ì´í•´í•˜ë ¤ê³  í•˜ì˜€ë‹¤. lis(idx1) == lis(idx2) + 1 ì¸ ì¡°ê±´ì„ ë³¼ ë•Œ, ì™œ ê·¸ë ‡ê²Œ ë˜ëŠ”ê°€?? ë¼ê³  ê³ ë¯¼ì„ ê³„ì† í–ˆë‹¤. ë§ˆì¹¨ë‚´ + 1 ì˜ ì˜ë¯¸ê°€ í˜„ì¬ idx2 ì˜ ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ìˆ˜ì—´ì´ ë°”ë¡œ arr[idx1] ê³¼ ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°ë¨ì„ ë‚˜íƒ€ë‚¸ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ë‹¤!!! ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ìˆ˜ì—´ì˜ ê°œìˆ˜ë¥¼ í†µí•´ í˜„ì¬ arr[idx1]ì—ì„œ ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°ë  ìˆ˜ ìˆëŠ” ìˆ«ìë“¤ì„ ë³´ê´€í•´ì„œ arrì— ì €ì¥ëœ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ì„ í•˜ì—¬ ë‹¤ìŒ ìˆ˜ì—´ì´ skipì´ ê°€ëŠ¥í•œì§€ íŒë‹¨í•˜ëŠ” ê²ƒì´ë‹¤. ì˜¤ë¦„ì°¨ìˆœì€ ì‚¬ì „ìˆœìœ¼ë¡œ ì˜¤ëŠ” ì¦ê°€ ìˆ˜ì—´ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œ! íœ´,, 3ì‹œê°„ë™ì•ˆ ì´ í•œ ë¬¸ì œë¥¼ ê³ ë¯¼í•´ì„œ ë§ˆì¹¨ë‚´ ì´í•´í•  ìˆ˜ ìˆì—ˆë‹¤.

> count í•˜ëŠ” ê³¼ì •ë„ í•œì°¸ ë³´ê³  ê·¸ë¦¼ì„ ê·¸ë ¤ê°€ë©° ìƒê°í•´ì„œ ê²¨ìš° ì´í•´í–ˆë‹¤.. ì „ë°˜ì ì¸ ê³¼ì •ì€ lisë¥¼ êµ¬í•˜ëŠ” ì½”ë“œì™€ ìœ ì‚¬í•˜ë‹¤. í•˜ì§€ë§Œ ê¸°ì € ì‚¬ë¡€ê°€ lis(idx) == 1 ì¼ ê²½ìš° 1ì„ ë¦¬í„´í•˜ëŠ” ê²ƒì´ lisì™€ ë‹¬ëë‹¤. lisì—ì„œëŠ” ë‹¨ìˆœíˆ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ë°˜ë³µë¬¸ìœ¼ë¡œ arrì˜ sizeë³´ë‹¤ ì‘ì„ ë•Œ ê¹Œì§€ë§Œìœ¼ë¡œ ì œí•œí•´ë‘¬ì„œ ë³„ë‹¤ë¥¸ ê¸°ì €ì‚¬ë¡€ê°€ ì¡´ì¬í•˜ì§€ ì•Šì•˜ë‹¤. í•˜ì§€ë§Œ countì˜ ê²½ìš°, ë” ì´ìƒ ì¦ê°€ê°€ ë¶ˆê°€ëŠ¥í•œ ê°’ì„ ë§Œë‚˜ë©´ 1ì„ ë¦¬í„´í•´ì¤€ë‹¤. ê·¸ë˜ì„œ ì´ëŸ¬í•œ ê³¼ì •ì´ ì–´ë–»ê²Œ, ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê°œìˆ˜ë¥¼ êµ¬í•  ìˆ˜ ìˆëŠ”ê°€ ì˜ë¬¸ì´ ë“¤ì—ˆë‹¤.

> í•˜ì§€ë§Œ ìì„¸íˆ ë³´ë‹ˆ "ìµœëŒ€ ì¦ê°€ ìˆ˜ì—´ì˜ ê°œìˆ˜" ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ê°€ ì•„ë‹Œ "ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê°œìˆ˜" ë¥¼ êµ¬í•˜ëŠ” ê²ƒì´ì—ˆë‹¤. ì¦‰ idx1ë²ˆì§¸ ê°’ì—ì„œ (ìµœëŒ€ ì¦ê°€ ìˆ˜ì—´ì˜ ê¸¸ì´ - 1) ì„ ìì‹ ì˜ ìµœëŒ€ ì¦ê°€ ìˆ˜ì—´ì˜ ê¸¸ì´ë¡œ ê°€ì§€ëŠ” ì‹œì‘ idx2ë¥¼ êµ¬í•œë‹¤. ê·¸ëŸ° ë‹¤ìŒ idx2 ë²ˆì§¸ ê°’ì˜ "ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê°œìˆ˜" ë“¤ì„ ëª¨ë‘ ë”í•œ ê²ƒì´ idx1 ë²ˆì§¸ ê°’ì—ì„œ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê°œìˆ˜ê°€ ëœë‹¤!! ì´ëŸ¬í•œ ì¬ê·€ì ì¸ ì‚¬ê³ ë°©ì‹ì´ ê°€ëŠ¥í•œ ì´ìœ ëŠ” lis(idx1) = lis(idx2) + 1 ì´ë¼ëŠ” ì¡°ê±´ì„ í†µí•´ì„œ ê°€ëŠ¥í–ˆëŠ”ë°, ì´ëŠ” idx1 ì—ì„œ ì‹œì‘í•˜ëŠ” ì¦ê°€ìˆ˜ì—´ì— idx2 ì—ì„œ ì‹œì‘í•˜ëŠ” ì¦ê°€ìˆ˜ì—´ì´ í¬í•¨ëœë‹¤ëŠ” ëœ»ì´ê¸° ë•Œë¬¸ì´ë‹¤.

> ìš”ì•½í•˜ìë©´ lis(idx1) = lis(idx2) + 1 ì´ë¼ëŠ” ëœ»ì€, idx1 ë²ˆì§¸ ê°’ê³¼ idx2 ë²ˆì§¸ ê°’ì´ í•˜ë‚˜ì˜ ìµœëŒ€ ì¦ê°€ ìˆ˜ì—´ì— í¬í•¨ë˜ì–´ ë°”ë¡œ ë‹¤ìŒ ê°’ìœ¼ë¡œ ì„œë¡œ ì—°ê²°ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ ì¬ê·€ì ìœ¼ë¡œ ë‹¤ìŒì—” idx2 ì— ëŒ€í•´ì„œ ë“¤ì–´ê°€ê³ , ë‹¤ìŒì€ idx3 ... ì´ëŸ° ì‹ìœ¼ë¡œ ìˆ˜í–‰í•´ì„œ í•´ë‹¹ ì¦ê°€ ìˆ˜ì—´ì˜ ë§ˆì§€ë§‰ ê°’ì„ ë§Œë‚˜ë©´(lis(idx) == 1) 1ì„ ë°˜í™˜í•˜ê³  ì¢…ë£Œí•œë‹¤.

<hr/>

## í’€ì´ ğŸ“£

1ï¸âƒ£ ì£¼ì–´ì§„ ìˆ˜ì—´ì— ëŒ€í•´ ìµœëŒ€ ì¦ê°€ ìˆ˜ì—´ì˜ ê¸¸ì´ë¥¼ êµ¬í•œë‹¤. DPë¥¼ ì´ìš©í•´ì„œ ì°¨ë¡€ì°¨ë¡€ idxë¥¼ í•œê°œì”© ëŠ˜ë ¤ê°€ë©° ì²´í¬!

2ï¸âƒ£ for ë¬¸ì„ ëŒë©° í˜„ì¬ idx ì˜ ë‹¤ìŒì— ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°ë  ìˆ˜ ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ pair(arr[idx], idx) í˜•íƒœë¡œ ì €ì¥í•˜ì—¬ ë³´ê´€í•œë‹¤.

3ï¸âƒ£ ì´ëŸ¬í•œ pair ê°’ë“¤ì„ ì˜¤ë¦„ì°¨ìˆœ(ì‚¬ì „ìˆœ)ìœ¼ë¡œ ì •ë ¬í•œë‹¤.

4ï¸âƒ£ pairì˜ ê° idx ì—ì„œ ì‹œì‘í•˜ëŠ” ìµœëŒ€ ì¦ê°€ ë¶€ë¶„ ìˆ˜ì—´ì˜ ê°œìˆ˜ë¥¼ êµ¬í•œë‹¤.

5ï¸âƒ£ ë§Œì•½ skip ( skip == k -1 ) ê°’ì´ idx ì—ì„œì˜ ì¦ê°€ ìˆ˜ì—´ì˜ ê°œìˆ˜ë³´ë‹¤ í¬ë‹¤ë©´ skip ì—ì„œ ê·¸ ê°’ì„ ë¹¼ì¤€ë‹¤ -> ë›°ì–´ë„˜ëŠ”ë‹¤.

6ï¸âƒ£ skipì´ idx ì—ì„œì˜ ì¦ê°€ ìˆ˜ì—´ì˜ ê°œìˆ˜ë³´ë‹¤ ì‘ì•„ì§€ë©´, arr[idx]ë¥¼ answer ìŠ¤íŠ¸ë§ì— ì¶”ê°€í•˜ê³  idxì—ì„œ ë¶€í„° ë‹¤ì‹œ ì¬ê·€í˜¸ì¶œì„ ìˆ˜í–‰í•œë‹¤.

7ï¸âƒ£ ì´ ë•Œ, ë§Œì•½ arrì˜ ì¸ë±ìŠ¤ ë²”ìœ„ë¥¼ ì´ˆê³¼í•œë‹¤ë©´ forë¬¸ì˜ ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ê²½ìš°ê°€ ì—†ì–´ì„œ ì•„ë¬´ëŸ° ë™ì‘ì„ í•˜ì§€ ì•Šê³  ë°˜í™˜ë˜ê¸° ë•Œë¬¸ì— ê¸°ì € ì‚¬ë¡€ê°€ ì—†ì–´ë„ ëœë‹¤.

<hr/>

## ì‹¤ìˆ˜ ğŸ˜…

- ì½”ë“œ í•œì¤„ í•œì¤„ì´ í•œ ë²ˆì— ì´í•´í•˜ê¸°ì—” ì–´ë ¤ì› ë‹¤.. reconstruct ê³¼ì •ì—ì„œ startë¥¼ ìŠ¤íŠ¸ë§ì— ì €ì¥í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ arr[start]ë¥¼ ì €ì¥í•´ì•¼ í•˜ëŠ”ë° ì´ë¥¼ ì‹¤ìˆ˜í–ˆë‹¤.
